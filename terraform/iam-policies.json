{
  "TerraformExecutionPolicy": {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Sid": "EC2Permissions",
        "Effect": "Allow",
        "Action": [
          "ec2:*"
        ],
        "Resource": "*"
      },
      {
        "Sid": "RDSPermissions",
        "Effect": "Allow",
        "Action": [
          "rds:*",
          "rds-db:connect"
        ],
        "Resource": "*"
      },
      {
        "Sid": "ECSPermissions",
        "Effect": "Allow",
        "Action": [
          "ecs:*",
          "ec2:DescribeNetworkInterfaces"
        ],
        "Resource": "*"
      },
      {
        "Sid": "ECRPermissions",
        "Effect": "Allow",
        "Action": [
          "ecr:*"
        ],
        "Resource": "*"
      },
      {
        "Sid": "ELBPermissions",
        "Effect": "Allow",
        "Action": [
          "elasticloadbalancing:*"
        ],
        "Resource": "*"
      },
      {
        "Sid": "S3Permissions",
        "Effect": "Allow",
        "Action": [
          "s3:*"
        ],
        "Resource": "*"
      },
      {
        "Sid": "CloudFrontPermissions",
        "Effect": "Allow",
        "Action": [
          "cloudfront:*",
          "acm:*"
        ],
        "Resource": "*"
      },
      {
        "Sid": "CloudWatchPermissions",
        "Effect": "Allow",
        "Action": [
          "cloudwatch:*",
          "logs:*"
        ],
        "Resource": "*"
      },
      {
        "Sid": "IAMPermissions",
        "Effect": "Allow",
        "Action": [
          "iam:CreateRole",
          "iam:PutRolePolicy",
          "iam:AttachRolePolicy",
          "iam:DetachRolePolicy",
          "iam:DeleteRolePolicy",
          "iam:GetRole",
          "iam:GetRolePolicy",
          "iam:ListRolePolicies",
          "iam:ListAttachedRolePolicies",
          "iam:PassRole",
          "iam:CreatePolicy",
          "iam:CreatePolicyVersion",
          "iam:DeletePolicy",
          "iam:DeletePolicyVersion",
          "iam:GetPolicy",
          "iam:GetPolicyVersion",
          "iam:ListPolicyVersions",
          "iam:ListPolicies",
          "iam:CreateInstanceProfile",
          "iam:DeleteInstanceProfile",
          "iam:AddRoleToInstanceProfile",
          "iam:RemoveRoleFromInstanceProfile",
          "iam:GetInstanceProfile",
          "iam:ListInstanceProfiles",
          "iam:ListInstanceProfilesForRole",
          "iam:CreateServiceLinkedRole"
        ],
        "Resource": "*"
      },
      {
        "Sid": "Route53Permissions",
        "Effect": "Allow",
        "Action": [
          "route53:*"
        ],
        "Resource": "*"
      },
      {
        "Sid": "SecretsManagerPermissions",
        "Effect": "Allow",
        "Action": [
          "secretsmanager:*"
        ],
        "Resource": "*"
      },
      {
        "Sid": "SNSPermissions",
        "Effect": "Allow",
        "Action": [
          "sns:*"
        ],
        "Resource": "*"
      },
      {
        "Sid": "AutoScalingPermissions",
        "Effect": "Allow",
        "Action": [
          "autoscaling:*",
          "application-autoscaling:*"
        ],
        "Resource": "*"
      },
      {
        "Sid": "TerraformStatePermissions",
        "Effect": "Allow",
        "Action": [
          "s3:GetObject",
          "s3:PutObject",
          "s3:DeleteObject",
          "s3:ListBucket",
          "dynamodb:GetItem",
          "dynamodb:PutItem",
          "dynamodb:DeleteItem",
          "dynamodb:DescribeTable"
        ],
        "Resource": [
          "arn:aws:s3:::llmops-terraform-state/*",
          "arn:aws:s3:::llmops-terraform-state",
          "arn:aws:dynamodb:*:*:table/llmops-terraform-locks"
        ]
      }
    ]
  },
  "GitHubActionsPolicy": {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Sid": "ECRPushPermissions",
        "Effect": "Allow",
        "Action": [
          "ecr:GetDownloadUrlForLayer",
          "ecr:BatchGetImage",
          "ecr:PutImage",
          "ecr:InitiateLayerUpload",
          "ecr:UploadLayerPart",
          "ecr:CompleteLayerUpload",
          "ecr:GetAuthorizationToken",
          "ecr:DescribeImages"
        ],
        "Resource": "arn:aws:ecr:*:*:repository/llmops-system"
      },
      {
        "Sid": "ECSDeployPermissions",
        "Effect": "Allow",
        "Action": [
          "ecs:UpdateService",
          "ecs:DescribeServices",
          "ecs:DescribeTaskDefinition",
          "ecs:DescribeTask",
          "ecs:ListTasks",
          "ecs:RegisterTaskDefinition"
        ],
        "Resource": [
          "arn:aws:ecs:*:*:service/llmops-cluster/llmops-service",
          "arn:aws:ecs:*:*:task-definition/llmops-task:*",
          "arn:aws:ecs:*:*:task/llmops-cluster/*"
        ]
      },
      {
        "Sid": "IAMPassRolePermissions",
        "Effect": "Allow",
        "Action": [
          "iam:PassRole"
        ],
        "Resource": [
          "arn:aws:iam::*:role/ecsTaskExecutionRole",
          "arn:aws:iam::*:role/ecsTaskRole"
        ]
      }
    ]
  },
  "ECSTaskExecutionRolePolicy": {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Sid": "ECRAccess",
        "Effect": "Allow",
        "Action": [
          "ecr:GetAuthorizationToken",
          "ecr:BatchGetImage",
          "ecr:GetDownloadUrlForLayer"
        ],
        "Resource": "*"
      },
      {
        "Sid": "CloudWatchLogsAccess",
        "Effect": "Allow",
        "Action": [
          "logs:CreateLogGroup",
          "logs:CreateLogStream",
          "logs:PutLogEvents"
        ],
        "Resource": "arn:aws:logs:*:*:log-group:/ecs/llmops-task*"
      },
      {
        "Sid": "SecretsManagerAccess",
        "Effect": "Allow",
        "Action": [
          "secretsmanager:GetSecretValue",
          "secretsmanager:DescribeSecret"
        ],
        "Resource": "arn:aws:secretsmanager:*:*:secret:llmops/*"
      }
    ]
  },
  "ECSTaskRolePolicy": {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Sid": "S3Access",
        "Effect": "Allow",
        "Action": [
          "s3:GetObject",
          "s3:PutObject",
          "s3:DeleteObject",
          "s3:ListBucket"
        ],
        "Resource": [
          "arn:aws:s3:::llmops-assets/*",
          "arn:aws:s3:::llmops-assets"
        ]
      },
      {
        "Sid": "SecretsManagerAccess",
        "Effect": "Allow",
        "Action": [
          "secretsmanager:GetSecretValue"
        ],
        "Resource": "arn:aws:secretsmanager:*:*:secret:llmops/*"
      },
      {
        "Sid": "CloudWatchMetrics",
        "Effect": "Allow",
        "Action": [
          "cloudwatch:PutMetricData"
        ],
        "Resource": "*"
      }
    ]
  }
}
